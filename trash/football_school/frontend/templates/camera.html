<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ª–∏—Ü</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        /* –¢–µ–º–Ω—ã–π —Ñ–æ–Ω –¥–ª—è main-content */
        .game-main-content {
            background: var(--theme-bg-primary);
            min-height: 100vh;
            padding: 0 !important;
            margin-left: 280px !important;
            width: calc(100% - 280px) !important;
        }
        
        body.theme-light .game-main-content {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
        
        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø—Ä–∏ —Å–≤–µ—Ä–Ω—É—Ç–æ–º sidebar */
        body:has(.sidebar.collapsed) .game-main-content,
        .sidebar.collapsed ~ .main-content.game-main-content {
            margin-left: 80px !important;
            width: calc(100% - 80px) !important;
        }
        
        /* –ò–≥—Ä–æ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å—Ç–∏–ª–∏ */
        .game-layout {
            display: flex;
            flex-direction: column;
            gap: 0;
            height: 100vh;
            background: var(--theme-bg-primary);
            overflow: hidden;
            transition: background-color 0.3s ease;
        }
        
        body.theme-light .game-layout {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
    </style>
</head>
<body>
    {% include '_sidebar.html' %}

    <div class="main-content game-main-content">
        <!-- –ò–≥—Ä–æ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
        <div class="game-layout">
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
            <div style="flex: 1; overflow-y: auto; padding: 24px;">
        
        <div class="camera-container">
            <div class="camera-box">
                <video id="camera" autoplay playsinline></video>
                <canvas id="canvas" style="display:none;"></canvas>
                
                <div class="camera-controls">
                    <button id="startCamera" class="btn-success">üé• –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–≤—Ç–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
                </div>
                <div style="margin-top: 10px; text-align: center; color: #7f8c8d; font-size: 0.9rem;">
                    –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –∫–∞–º–µ—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –ª–∏—Ü–∞ –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
                </div>
            </div>

            <!-- –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ: –°–µ–≥–æ–¥–Ω—è –Ω–∞ –∑–∞–Ω—è—Ç–∏–∏ —Ä—è–¥–æ–º —Å –∫–∞–º–µ—Ä–æ–π -->
            <div class="today-list">
                <div class="today-header">
                    <h2>–°–µ–≥–æ–¥–Ω—è –Ω–∞ –∑–∞–Ω—è—Ç–∏–∏</h2>
                    <span class="today-counter" id="todayCounter">0 —á–µ–ª–æ–≤–µ–∫</span>
                </div>
                <div class="today-columns">
                    <span>–§–æ—Ç–æ</span>
                    <span>–í—Ä–µ–º—è</span>
                    <span>–£—á–µ–Ω–∏–∫</span>
                    <span>–ì—Ä—É–ø–ø–∞</span>
                    <span>–û—Å—Ç–∞—Ç–æ–∫ –∑–∞–Ω—è—Ç–∏–π</span>
                </div>
                <div id="todayList" class="today-items">
                    <div class="info-text">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>
            </div>
        </div>

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–∞–∑–º–µ—â—ë–Ω –Ω–∏–∂–µ -->
        <div class="recognition-panel">
            <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è</h3>
            <div id="recognitionResult">
                <p class="info-text">–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–∞–º–µ—Ä—É –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</p>
            </div>
            
            <div id="studentInfo" style="display:none;">
                <img id="studentPhoto" src="" alt="–§–æ—Ç–æ —É—á–µ–Ω–∏–∫–∞">
                <h2 id="studentName"></h2>
                <p>–ë–∞–ª–∞–Ω—Å: <span id="studentBalance" class="balance-badge"></span> –∑–∞–Ω—è—Ç–∏–π</p>
                <button id="checkinBtn" class="btn-success btn-large">‚úì –û—Ç–º–µ—Ç–∏—Ç—å –ø—Ä–∏—Ö–æ–¥</button>
            </div>
            
            <div id="lowBalanceAlert" style="display:none;" class="alert-danger">
                <h3>‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–∞–Ω—è—Ç–∏–π!</h3>
                <p>–£ —É—á–µ–Ω–∏–∫–∞ –∑–∞–∫–æ–Ω—á–∏–ª—Å—è –±–∞–ª–∞–Ω—Å</p>
            </div>
        </div>
    </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/camera.js') }}"></script>
    <script src="{{ url_for('static', filename='js/sidebar.js') }}"></script>
    <script src="{{ url_for('static', filename='js/theme.js') }}"></script>
</body>
</html>
